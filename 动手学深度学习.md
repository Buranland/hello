动手学深度学习-Pytorch

1、Tensor数据

- 创建

  - torch.empty(5,3)
  - torch.rand(5,3,dtype=torch.long)
  - torch.tensor([4,3])
  - torch.new_ones(5,3)
  - torch.randn_like(x)

- 操作

  - 加法

- 索引：通过索引访问矩阵值；索引共享内存；

- 改变形状：

  - x.view()
  - 但是改变后的形状共享数据；
  - clone可以创造新的副本；

- tensor与numpy转化：共享内存

  - torch -- > numpy : a.numpy;

  - numpy -- > torch : torch.from_numpy( a )

  - ```python
    if torch.cuda.is_available():
        device = torch.device("cuda")          # GPU
        y = torch.ones_like(x, device=device)  # 直接创建一个在GPU上的Tensor
        x = x.to(device)                       # 等价于 .to("cuda")
    ```

2、自动求梯度

- 链式法则追踪，从而梯度传播；设置Requires_grad=True；

  ```python
  x = torch.ones(2, 2, requires_grad=True)
  print(x)
  print(x.grad_fn)
  ```

  ```python
  # 输出结果
  tensor([[1., 1.],
          [1., 1.]], requires_grad=True)
  None
  ```

  ```python
  y = x + 2
  print(y)
  print(y.grad_fn)
  ```

  ```python
  # 输出结果
  tensor([[3., 3.],
          [3., 3.]], grad_fn=<AddBackward>)
  <AddBackward object at 0x1100477b8>
  ```

  

  - 直接创建的是叶子节点，可以通过 is_leaf 判断；

- 梯度

  - out.backward()
  - x.grad
  - 

- 